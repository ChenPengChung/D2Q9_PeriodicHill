//此篇為定義MRT碰撞算子的鬆弛矩陣S與分佈函數的基底變換矩陣
#ifndef MRT_Matrix_FILE
#define MRT_Matrix_FILE

//=============================================================================
// D2Q9 MRT 矩陣定義
// 參考: TimKruger 第422頁
//=============================================================================

//-----------------------------------------------------------------------------
// 鬆弛矩陣 S (對角矩陣)
// s0, s3, s5: 守恆量 (密度、動量) → 設為 0
// s1: 能量鬆弛 → omega_2
// s2, s4, s6: free parameters → 設為 1.0
// s7, s8: 剪切黏滯相關 → omega_7
//-----------------------------------------------------------------------------
#define Relaxation \
    double s0 = 0.0; \
    double s1 = omega_2; \
    double s2 = 1.2; \
    double s3 = 0.0; \
    double s4 = 1.2; \
    double s5 = 0.0; \
    double s6 = 1.2; \
    double s7 = omega_7; \
    double s8 = omega_7

//-----------------------------------------------------------------------------
// 分佈函數的基底變換矩陣 M
// m = M * f  (從分佈函數空間轉換到矩空間)
//-----------------------------------------------------------------------------
#define Matrix \
    double M[9][9] = { \
        { 1,  1,  1,  1,  1,  1,  1,  1,  1}, \
        {-4, -1, -1, -1, -1,  2,  2,  2,  2}, \
        { 4, -2, -2, -2, -2,  1,  1,  1,  1}, \
        { 0,  1,  0, -1,  0,  1, -1, -1,  1}, \
        { 0, -2,  0,  2,  0,  1, -1, -1,  1}, \
        { 0,  0,  1,  0, -1,  1,  1, -1, -1}, \
        { 0,  0, -2,  0,  2,  1,  1, -1, -1}, \
        { 0,  1, -1,  1, -1,  0,  0,  0,  0}, \
        { 0,  0,  0,  0,  0,  1, -1,  1, -1}  \
}

//-----------------------------------------------------------------------------
// 逆變換矩陣 M^(-1)
// f = M^(-1) * m  (從矩空間轉換回分佈函數空間)
//-----------------------------------------------------------------------------
#define Matrix_Inverse \
    double M_I[9][9] = { \
        {1/9.0,  -1/9.0,  1/9.0,   0.0,     0.0,     0.0,    0.0,     0.0,    0.0   }, \
        {1/9.0,  -1/36.0, -1/18.0, 1/6.0,  -1/6.0,   0.0,    0.0,     1/4.0,  0.0   }, \
        {1/9.0,  -1/36.0, -1/18.0, 0.0,     0.0,     1/6.0, -1/6.0,  -1/4.0,  0.0   }, \
        {1/9.0,  -1/36.0, -1/18.0, -1/6.0,  1/6.0,   0.0,    0.0,     1/4.0,  0.0   }, \
        {1/9.0,  -1/36.0, -1/18.0, 0.0,     0.0,    -1/6.0,  1/6.0,  -1/4.0,  0.0   }, \
        {1/9.0,  1/18.0,  1/36.0,  1/6.0,   1/12.0,  1/6.0,  1/12.0,  0.0,    1/4.0 }, \
        {1/9.0,  1/18.0,  1/36.0, -1/6.0,  -1/12.0,  1/6.0,  1/12.0,  0.0,   -1/4.0 }, \
        {1/9.0,  1/18.0,  1/36.0, -1/6.0,  -1/12.0, -1/6.0, -1/12.0,  0.0,    1/4.0 }, \
        {1/9.0,  1/18.0,  1/36.0,  1/6.0,   1/12.0, -1/6.0, -1/12.0,  0.0,   -1/4.0 }  \
}



#endif // MRT_Matrix_FILE
